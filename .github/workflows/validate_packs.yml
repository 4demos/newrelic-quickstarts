name: Validate Packs

on:
  workflow_dispatch:
  pull_request:
   
  # TODO: we want the following trigger for forks, but we will need to validate potentially insecure content.
  # it might be worth having this in its own workflow, depending on what we need to do.
  #
  # pull_request_target:
  #   paths:
  #     - '**/*.yml'

jobs:
  validate-packs:
    name: Validate Packs
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2
    
    #TODO: FOR WORKING WITH FORKS, test all this with forked repos
    # - uses: actions/checkout@v2
      # with:
        # ref: ${{github.event.pull_request.head.ref}}
        # repository: ${{github.event.pull_request.head.repo.full_name}}

      - name: Setup Node.js
        uses: actions/setup-node@v2
        with:
          node-version: 12
  
      - name: Install dependencies
        run: |
          yarn install

      - name: Validate files
        id: validate-files
        run: |
          yarn validate-packs 
